

components:


  - name: hive-metastore
    createNamespace: true
    vars:
      s3access:
        url: # TBD
        accessKey:  # TBD. Leave blank if secret is created outside
        secretKey:  # TBD
    modules:
      - name: main
        source: flux-system
        config:
          timeout:  "5m"
        chart:
          path: ./charts/kdp-hive-metastore/0.1.0
        values: |
          # fullNameOverride: hive-metastore-main   # Was based on releaseName, which contains the namespace
          s3Secret:
            accessKey: {{ .Vars.s3access.accessKey }}
            secretKey: {{ .Vars.s3access.secretKey }}
          hive-metastore:
            serviceName: hive-metastore # Default was <namespace>-hive-metastore-main
            s3:
              url: {{ .Vars.s3access.url }} 
              accessKey:
                secretName: kdp-hive-metastore-s3-secret
                propertyName: accessKey
              secretKey:
                secretName: kdp-hive-metastore-s3-secret
                propertyName: secretKey
            networkPolicies:
              enabled: {{ .Context.networkPoliciesSupport }}
          pgcluster:
            storage:
              storageClass: {{ .Context.storageClass.data }}
